{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.js","webpack:///./src/client/axios.js","webpack:///./src/components/Header.js","webpack:///./src/containers/Home/index.js","webpack:///./src/containers/Home/store/action.js","webpack:///./src/containers/Home/store/index.js","webpack:///./src/containers/Home/store/reducer.js","webpack:///./src/containers/Login/index.js","webpack:///./src/routes/index.js","webpack:///./src/server/axios.js","webpack:///./src/server/index.js","webpack:///./src/server/root.js","webpack:///./src/store/index.js","webpack:///./src/store/reducers.js","webpack:///external \"axios\"","webpack:///external \"express\"","webpack:///external \"express-http-proxy\"","webpack:///external \"react\"","webpack:///external \"react-dom/server\"","webpack:///external \"react-redux\"","webpack:///external \"react-router-config\"","webpack:///external \"react-router-dom\"","webpack:///external \"redux\"","webpack:///external \"redux-thunk\""],"names":["props","route","routes","instance","axios","create","baseURL","actions","Home","list","state","homeReducer","length","getHomeList","map","item","index","title","React","Component","loadData","store","dispatch","CHANGE_HOME_LIST","changeList","data","type","getState","get","then","res","reducer","defaultState","action","Login","name","path","component","App","exact","app","use","express","static","proxyReqPathResolver","req","url","server","listen","host","address","port","console","log","matchedRoutes","promises","forEach","push","Promise","all","content","send","JSON","stringify","createServerStore","reducers","thunk","withExtraArgument","serverAxios","createClientStore","defaultStore","window","_context","clientAxios"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/server/index.js\");\n","import React from 'react';\r\nimport { renderRoutes } from 'react-router-config';\r\nimport Header from './components/Header'\r\n\r\nexport default (props) => {\r\n    return (\r\n        <div>\r\n            <Header />\r\n            {renderRoutes(props.route.routes)}\r\n        </div>\r\n    )\r\n}\r\n","import axios from 'axios';\r\n\r\n// 创建实例时修改配置\r\nvar instance = axios.create({\r\n    baseURL: ''\r\n});\r\n\r\nexport default instance;\r\n","import React from 'react';\r\nimport { Link } from \"react-router-dom\";\r\n\r\nexport default () => {\r\n    return (\r\n        <div>\r\n            <Link to=\"/home\">home</Link>---\r\n            <Link to=\"/login\">login</Link>\r\n        </div>\r\n    )\r\n}\r\n","import React from 'react';\r\nimport { connect } from 'react-redux';\r\n// import { getHomeList } from './store/action';\r\nimport * as actions from './store/action';\r\n\r\n// @connect(\r\n//   state => ({ list: state.homeReducer.list }),\r\n//   dispatch => ({\r\n//     getHomeList() {\r\n//       dispatch(getHomeList());\r\n//     }\r\n//   }),\r\n// )\r\n@connect(\r\n  state => ({ list: state.homeReducer.list }),\r\n  actions\r\n)\r\nclass Home extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n  }\r\n  // 只在客户端执行\r\n  componentDidMount() {\r\n    // 当在浏览器渲染的时候，只有数据不存在事执行获取\r\n    if (this.props.list.length === 0) {\r\n      this.props.getHomeList();\r\n    }\r\n  }\r\n  render() {\r\n    return (\r\n      <div>\r\n        {\r\n          this.props.list.map((item, index) => (<p key={index}>{item.title}</p>))\r\n        }\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n// https://reacttraining.com/react-router/web/guides/server-rendering\r\nHome.loadData = (store) => {\r\n  // 负责页面渲染之前，在路由数据提前加载好\r\n  // 把action 内 返回的 Promise 在返回出去，执行多个用 Promise.all 处理\r\n  return store.dispatch(actions.getHomeList());\r\n}\r\n\r\nexport default Home;\r\n","export const CHANGE_HOME_LIST = 'CHANGE_HOME_LIST';\r\n\r\nexport const changeList = (data) => ({\r\n    type: CHANGE_HOME_LIST,\r\n    data\r\n})\r\n\r\n\r\nexport const getHomeList = () => {\r\n    return (dispatch, getState, axios) => {\r\n        // 返回 Promise 对象，在服务端执行\r\n        // 代理前地址： http://47.95.113.63/ssr/api/news.json?secret=M5s2sPneDE\r\n        // 浏览器渲染请求的地址： http://localhost:8081/api/news.json?secret=M5s2sPneDE\r\n        // 服务端渲染请求的地址： /api/news.json?secret=M5s2sPneDE\r\n        // let url = '';\r\n        // if (server) {\r\n        //     url = 'http://47.95.113.63/ssr/api/news.json?secret=M5s2sPneDE'\r\n        // } else {\r\n        //     url = '/api/news.json?secret=M5s2sPneDE'\r\n        // }\r\n\r\n        // 问题：在服务端渲染的时候这个文件找不到会报错，因此服务端渲染时要请求后端完整路径\r\n        //       http://47.95.113.63/ssr/api/news.json?secret=M5s2sPneDE\r\n        return axios.get('/api/news.json?secret=M5s2sPneDE').then((res) => {\r\n            let list = res.data.data;\r\n            dispatch(changeList(list));\r\n        });\r\n    }\r\n}\r\n","import reducer from './reducer';\r\n\r\nexport { reducer };\r\n","import { CHANGE_HOME_LIST } from './action';\r\n\r\nconst defaultState = {\r\n    list: []\r\n}\r\n// reducer 接收 action 派发\r\nexport default (state = defaultState, action) => {\r\n    switch (action.type) {\r\n        case CHANGE_HOME_LIST:\r\n            return {\r\n                ...state,\r\n                list: action.data\r\n            };\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n","import React from 'react';\r\nimport { Link } from \"react-router-dom\";\r\n\r\nclass Login extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            name: 'Login',\r\n        };\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                {this.state.name}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default Login;\r\n","import App from '../App';\r\nimport Home from '../containers/Home';\r\nimport Login from '../containers/Login';\r\n\r\n// export default [\r\n//     {\r\n//         path: '/',\r\n//         component: Home,\r\n//         exact: true, // 表示路由精确匹配\r\n//         loadData: Home.loadData\r\n//     },\r\n//     {\r\n//         path: '/home',\r\n//         component: Home,\r\n//         loadData: Home.loadData\r\n//     },\r\n//     {\r\n//         path: '/login',\r\n//         component: Login\r\n//     }\r\n// ]\r\n\r\nexport default [\r\n    {\r\n        path: '/',\r\n        component: App,\r\n        routes: [\r\n            {\r\n                path: '/',\r\n                component: Home,\r\n                exact: true, // 表示路由精确匹配\r\n                loadData: Home.loadData\r\n            },\r\n            {\r\n                path: '/home',\r\n                component: Home,\r\n                exact: true, // 表示路由精确匹配\r\n                loadData: Home.loadData\r\n            },\r\n            {\r\n                path: '/login',\r\n                exact: true,\r\n                component: Login\r\n            }\r\n        ]\r\n    }\r\n]\r\n","import axios from 'axios';\r\n\r\n// 创建实例时修改配置\r\nvar instance = axios.create({\r\n    baseURL: 'http://47.95.113.63/ssr'\r\n});\r\n\r\nexport default instance;\r\n","import Root from './root';\r\nimport express from 'express';\r\nimport proxy from 'express-http-proxy';\r\nvar app = express();\r\napp.use(express.static('public'));\r\napp.use('/client', express.static('client'));\r\n// 代理浏览器接口请求\r\napp.use('/api', proxy('http://47.95.113.63', {\r\n    proxyReqPathResolver: function (req) {\r\n        // req.url: /news.json?secret=M5s2sPneDE\r\n        // http://47.95.113.63/ssr/api/news.json?secret=M5s2sPneDE\r\n        return '/ssr/api' + req.url\r\n    }\r\n}));\r\n\r\napp.get('*', function (req, res) {\r\n    Root(req, res);\r\n})\r\n\r\nvar server = app.listen(8081, function () {\r\n    var host = server.address().address\r\n    var port = server.address().port\r\n    console.log(\"应用实例，访问地址为 http://%s:%s\", host, port)\r\n})\r\n","import React from 'react';\r\nimport { renderToString } from 'react-dom/server';\r\nimport { StaticRouter } from 'react-router-dom'; // matchPath： 只能匹配到一层路由，不能匹配到多级路由\r\nimport { matchRoutes, renderRoutes } from 'react-router-config';\r\nimport { Provider } from 'react-redux';\r\nimport { createServerStore } from '../store';\r\nimport routes from '../routes';\r\n\r\nexport default (req, res) => {\r\n    const store = createServerStore();\r\n    // const promises = []\r\n    // routes.some(route => {\r\n    //     // 使用 matchPath 方法，匹配路由对应要展示的页面组件\r\n    //     const match = matchPath(req.path, route);\r\n    //     if (match) {\r\n    //         promises.push(match);\r\n    //     }\r\n    //     return match;\r\n    // })\r\n    // console.log(promises);\r\n\r\n    // 通过 matchRoutes 能匹配到路由的多级嵌套页面组件\r\n    const matchedRoutes = matchRoutes(routes, req.path);\r\n    let promises = [];\r\n    // 执行 promises 内组件的 loadData 方法，获取数据\r\n    matchedRoutes.forEach(item => {\r\n        // 调用加载数据方法\r\n        if (item.route.loadData) {\r\n            // 把返回的 Promise 添加到数组中\r\n            promises.push(item.route.loadData(store));\r\n        }\r\n    })\r\n\r\n    // 打印出来的数据时默认值，因为ajax是异步，必须等待请求执行完成，在打印\r\n    // console.log(store.getState());\r\n\r\n    // 等到所有的 Promise 都执行成功，在去渲染页面\r\n    Promise.all(promises).then(() => {\r\n        // 打印出来的数据是有值的，说明组件提前要加载的数据成功\r\n        console.log(store.getState());\r\n\r\n        let content = renderToString(\r\n            <Provider store={store}>\r\n                <StaticRouter location={req.url} context={{}}>\r\n                    {renderRoutes(routes)}\r\n                </StaticRouter>\r\n            </Provider>\r\n        )\r\n        res.send(`\r\n            <!DOCTYPE html>\r\n            <html>\r\n                <head>\r\n                    <title>react</title>\r\n                </head>\r\n                <body>\r\n                    <div id=\"root\">${content}</div>\r\n                    <script>\r\n                        window._context = {\r\n                            state: ${JSON.stringify(store.getState())}\r\n                        }\r\n                    </script>\r\n                    <script src=\"/client/index.js\"></script>\r\n                </body>\r\n            </html>\r\n        `)\r\n    })\r\n};\r\n","import { createStore, compose, applyMiddleware } from 'redux';\r\nimport thunk from 'redux-thunk';\r\nimport reducers from './reducers';\r\nimport serverAxios from '../server/axios';\r\nimport clientAxios from '../client/axios';\r\n\r\n// export default () => {\r\n//     const store = createStore(reducers, compose(\r\n//         applyMiddleware(thunk)\r\n//     ));\r\n//     return store;\r\n// }\r\n\r\nexport const createServerStore = () => {\r\n    const store = createStore(reducers, compose(\r\n        applyMiddleware(thunk.withExtraArgument(serverAxios))\r\n    ));\r\n    return store;\r\n}\r\n\r\nexport const createClientStore = () => {\r\n    // 把服务端返回的数据，做为客户端默认数据使用。客户端的数据和服务器端的数据一致\r\n    // 实现数据注水和脱水\r\n    const defaultStore = window._context.state;\r\n    const store = createStore(reducers, defaultStore, compose(\r\n        applyMiddleware(thunk.withExtraArgument(clientAxios))\r\n    ));\r\n    return store;\r\n}\r\n","import { combineReducers } from 'redux';\r\nimport { reducer as homeReducer } from '../containers/Home/store';\r\n\r\n// 合并系统全部Reducer\r\nexport default combineReducers({\r\n    homeReducer\r\n});\r\n","module.exports = require(\"axios\");","module.exports = require(\"express\");","module.exports = require(\"express-http-proxy\");","module.exports = require(\"react\");","module.exports = require(\"react-dom/server\");","module.exports = require(\"react-redux\");","module.exports = require(\"react-router-config\");","module.exports = require(\"react-router-dom\");","module.exports = require(\"redux\");","module.exports = require(\"redux-thunk\");"],"sourceRoot":""}